{"version":3,"sources":["audioContext.js","audio/Sequencer.js","noteHelpers.js","Composer.js","Footer.js","GAListener.js","Header.js","audio/Oscillator.js","Keyboard.js","Label.js","CustomSettings.js","EqualTemperamentSettings.js","Settings.js","Tutorial.js","App.js","index.js"],"names":["audioContext","window","AudioContext","Sequencer","_this","this","_ref3","arguments","length","undefined","sequences","totalDuration","gain","Object","classCallCheck","play","playSequences","playSequencesInterval","setInterval","stop","clearInterval","oscillators","forEach","oscillator","sequence","playSequence","push","context","_this2","now","currentTime","gainNode","createGain","value","connect","destination","createOscillator","type","start","setValueAtTime","_ref4","_ref5","slicedToArray","freq","offset","duration","frequency","Math","max","apply","toConsumableArray","map","_ref","_ref2","getEndTime","CENTS_IN_OCTAVE","getCustomCentsForNote","note","customCentValues","centOffset","octave","floor","getFrequency","rootFrequency","numOctaves","numSteps","pow","getFrequencyRatio","getCentsForNote","config","useCustomCentValues","getFrequencyForNote","midiNumber","lowestNoteMidiNumber","MidiNumbers","fromNote","lowestNote","A440","cents","getFrequencyFromCents","getStepFrequencies","_","range","getNoteFromOffset","sortedNotes","sortBy","keys","selectedNotes","str","parseInt","numNotes","remainder","getNoteLabel","Step","props","onClick","selected","onDeselect","onSelect","react_default","a","createElement","className","classNames","sequence-item-selected","sequence-item-current","current","draggable","onDragEnter","onDragStart","ComposerSettings","onPlay","onStop","onClear","onExport","Composer","possibleConstructorReturn","getPrototypeOf","call","stepDuration","getStepDuration","getNumSteps","selectedSteps","frequencies","selectedStepIndexes","filter","timeIndex","buildSequences","state","currentAudioSequencer","AudioSequencer","updateCurrentStepAtInterval","setState","currentStep","clearSelectedSteps","getInitialSelectedSteps","onSelectItem","update","defineProperty","$set","steps","stepIndex","fetch","method","headers","Accept","Content-Type","body","JSON","stringify","short_id","shortid","generate","title","json_value","scaleConfig","bpm","getBeatsPerMinute","then","response","console","log","renderRow","key","round","renderRowSteps","isSelected","bind","assertThisInitialized","shortID","concat","json","data","nextProps","isEqual","getNumNotes","_this3","descendingNoteOffsets","React","Component","Footer","href","sendPageView","location","ReactGA","set","page","pathname","pageview","GAListener","children","trackingId","history","useEffect","initialize","listen","propTypes","PropTypes","node","string","shape","func","withRouter","Header","style","paddingTop","paddingBottom","width","height","left","react_router_dom","fontWeight","to","Oscillator","options","disconnect","KEY_LABELS_IN_ROWS","KEY_LABELS","join","Keyboard","startNote","stopNote","onKeyDown","event","ctrlKey","metaKey","shiftKey","onKeyActive","onKeyUp","onKeyInactive","activeNotes","bindEvents","addEventListener","removeEventListener","keyLabel","getNoteFromKeyLabel","assign","indexOf","getOffsetFromKeyLabel","Key--octave","Key--active","onMouseDown","onMouseUp","onMouseLeave","onTouchStart","onTouchCancel","onTouchEnd","reversedRowIndexes","rowIndex","keyLabels","split","renderKey","defaultProps","Label","DEFAULT_PRESET_NAME","PRESETS","name","label","values","PRESETS_MAP","reduce","elem","stringifyCustomCentValues","CustomSettings","onChangeCustomCentValues","customCentValuesStr","target","onSaveCustomCentValues","trim","parseFloat","sort","b","some","isNaN","Error","parseCustomCentValuesStr","setConfig","error","alert","onChangePreset","presetName","src_Label","rows","onChange","preset","EqualTemperamentSettings","onChangeLowestNote","reset","onChangeNumOctaves","onChangeNumSteps","onChangeSelectedNotes","checked","omit","onClickResetSelectedNotes","index","pluralize","NoteLabel--selected","noteName","renderStepSettings","renderLowestNoteSetting","renderNotePicker","Settings","useCustom","toggleCustomSettings","src_CustomSettings","src_EqualTemperamentSettings","Tutorial","src","alt","src_Keyboard","scrolling","frameBorder","allowFullScreen","SettingsWrapper","src_Settings","App","src_GAListener","src_Header","react_router","exact","path","render","src_Composer","match","params","src_Tutorial","src_Footer","ReactDOM","src_App_0","document","getElementById"],"mappings":"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","file":"static/js/main.af4e63d0.chunk.js","sourcesContent":["const audioContext = new window.AudioContext();\n\nexport default audioContext;\n","/*\n//TODO cleanup docs\nwindow.seq = new Sequencer(new window.AudioContext(), [\n  [\n    [440, 0, 1],\n    [400, 1, 1],\n    [550, 2, 1],\n    [480, 3, 1],\n  ],\n  [\n    [480, 0, 1],\n    [410, 1, 1],\n    [590, 2, 0.5],\n    [420, 5, 2],\n  ],\n]);\n*/\n\nfunction getEndTime(sequence) {\n  return Math.max(\n    ...sequence.map(([freq, offset, duration]) => {\n      return offset + duration;\n    }),\n  );\n}\n\n// TODO: refactor into objects instead of arrays\nclass Sequencer {\n  constructor({ audioContext, sequences, totalDuration, gain } = {}) {\n    this.context = audioContext;\n    this.gain = gain;\n    this.sequences = sequences;\n    this.totalDuration = totalDuration;\n    this.oscillators = [];\n    this.playSequencesInterval = null;\n  }\n\n  play = () => {\n    this.playSequences();\n    this.playSequencesInterval = setInterval(this.playSequences, this.totalDuration * 1000);\n  };\n\n  stop = () => {\n    clearInterval(this.playSequencesInterval);\n\n    this.oscillators.forEach((oscillator) => {\n      oscillator.stop();\n    });\n    this.oscillators = [];\n  };\n\n  playSequences = () => {\n    this.sequences.forEach((sequence) => {\n      const oscillator = this.playSequence(sequence);\n      this.oscillators.push(oscillator);\n    });\n  };\n\n  playSequence(sequence) {\n    const now = this.context.currentTime;\n\n    const gainNode = this.context.createGain();\n    gainNode.gain.value = this.gain;\n    gainNode.connect(this.context.destination);\n\n    const oscillator = this.context.createOscillator();\n    oscillator.type = 'sine';\n    oscillator.connect(gainNode);\n    oscillator.start(now);\n\n    gainNode.gain.setValueAtTime(0, now);\n\n    sequence.forEach(([freq, offset, duration]) => {\n      gainNode.gain.setValueAtTime(this.gain, now + offset);\n      gainNode.gain.setValueAtTime(0, now + offset + duration);\n      oscillator.frequency.setValueAtTime(freq, now + offset);\n    });\n\n    oscillator.stop(now + getEndTime(sequence));\n    return oscillator;\n  }\n}\n\nexport default Sequencer;\n","import _ from 'lodash';\nimport { MidiNumbers } from 'piano-utils';\n\nexport const CENTS_IN_OCTAVE = 1200;\n\nfunction getFrequencyRatio(note, numOctaves, numSteps) {\n  return Math.pow(2, note * (numOctaves / numSteps));\n}\n\nfunction getCustomCentsForNote(note, customCentValues) {\n  const offset = note % customCentValues.length;\n  const centOffset = customCentValues[offset];\n  const octave = Math.floor(note / customCentValues.length);\n  return CENTS_IN_OCTAVE * octave + centOffset;\n}\n\nexport function getFrequency(rootFrequency, note, numOctaves, numSteps) {\n  return rootFrequency * getFrequencyRatio(note, numOctaves, numSteps);\n}\n\nexport function getFrequencyFromCents(rootFrequency, cents) {\n  return rootFrequency * Math.pow(2, cents / CENTS_IN_OCTAVE);\n}\n\nexport function getCentsForNote(config, note) {\n  if (config.useCustomCentValues) {\n    return getCustomCentsForNote(note, config.customCentValues);\n  } else {\n    return ((CENTS_IN_OCTAVE * config.numOctaves) / config.numSteps) * note;\n  }\n}\n\n// TODO: port this to piano-utils\n// http://subsynth.sourceforge.net/midinote2freq.html\nfunction getFrequencyForMidiNumber(midiNumber) {\n  const A440 = 440;\n  return (A440 / 32) * Math.pow(2, (midiNumber - 9) / 12);\n}\n\nexport function getFrequencyForNote(config, note) {\n  const lowestNoteMidiNumber = MidiNumbers.fromNote(config.lowestNote);\n  const rootFrequency = getFrequencyForMidiNumber(lowestNoteMidiNumber);\n\n  if (config.useCustomCentValues) {\n    const centValue = getCustomCentsForNote(note, config.customCentValues);\n    return getFrequencyFromCents(rootFrequency, centValue);\n  } else {\n    return getFrequency(rootFrequency, note, config.numOctaves, config.numSteps);\n  }\n}\n\nexport function getStepFrequencies(config) {\n  return _.range(config.numSteps + 1).map((offset) => {\n    const note = getNoteFromOffset(config, offset);\n    return getFrequencyForNote(config, note);\n  });\n}\n\n// Notes are a numeric index into the microtone scale.\n// For example, given a standard 12 EDO scale, note 0 corresponds to lowestNote, note 12 corresponds\n// to 1200 cents above lowestNote, etc.\n//\n// Because you can select specific notes to include in the scale with state.config.selectedNotes,\n// we have offset which is slightly different from notes.\n// For example, if selectedNotes == {0, 3, 6}, offset 0 corresponds to note 0, offset 2 corresponds to note 6,\n// and offset 3 corresponds to note 12.\nexport function getNoteFromOffset(config, offset) {\n  const sortedNotes = _.sortBy(Object.keys(config.selectedNotes).map((str) => parseInt(str, 10)));\n  const numNotes = sortedNotes.length;\n  if (numNotes > 0) {\n    const octaves = Math.floor(offset / numNotes);\n    const remainder = offset % numNotes;\n    return octaves * config.numSteps + sortedNotes[remainder];\n  } else {\n    return offset;\n  }\n}\n\n// In 12EDO, 0 -> 1, 11 -> 12, 12 -> 1, 13 -> 2\nexport function getNoteLabel(config, note) {\n  return (note % config.numSteps) + 1;\n}\n","import React from 'react';\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport shortid from 'shortid';\nimport update from 'immutability-helper';\n\nimport audioContext from './audioContext';\nimport AudioSequencer from './audio/Sequencer';\nimport { getCentsForNote, getNoteFromOffset, getStepFrequencies } from './noteHelpers';\n\n// TODO: rename timeIndex => stepIndex\nfunction buildSequences({ selectedSteps, frequencies, stepDuration }) {\n  return Object.keys(selectedSteps)\n    .map((offset) => {\n      const selectedStepIndexes = Object.keys(selectedSteps[offset]).filter((timeIndex) => {\n        return selectedSteps[offset][timeIndex];\n      });\n      const frequency = frequencies[offset % frequencies.length];\n      return selectedStepIndexes.map((timeIndex) => {\n        return [frequency, timeIndex * stepDuration, stepDuration];\n      });\n    })\n    .filter((sequence) => {\n      return sequence.length > 0;\n    });\n}\n\nfunction Step(props) {\n  const onClick = props.selected ? props.onDeselect : props.onSelect;\n  // TODO: implement with onMouseDown instead? would change a flag on mouseDown so mouseEnter selects\n  return (\n    <div\n      className={classNames('col sequence-item py-1', {\n        'sequence-item-selected': props.selected,\n        'sequence-item-current': props.current,\n      })}\n      draggable\n      onClick={onClick}\n      onDragEnter={props.onSelect}\n      onDragStart={props.onSelect}\n    />\n  );\n}\n\nfunction ComposerSettings(props) {\n  return (\n    <div className=\"d-flex flex-row mb-3\">\n      <div className=\"flex-1\">\n        <div className=\"btn-group\">\n          <button className=\"btn btn-primary\" onClick={props.onPlay}>\n            Play\n          </button>\n          <button className=\"btn btn-secondary\" onClick={props.onStop}>\n            Stop\n          </button>\n        </div>\n        <button className=\"ml-2 btn btn-outline-secondary\" onClick={props.onClear}>\n          Clear\n        </button>\n      </div>\n      <div>\n        <button className=\"btn btn-outline-secondary\" onClick={props.onExport}>\n          Export as JSON\n        </button>\n      </div>\n    </div>\n  );\n}\n\nclass Composer extends React.Component {\n  constructor(props) {\n    super(props);\n\n    const frequencies = getStepFrequencies(props.config);\n    this.state = {\n      // TODO: move out of state? create higher order component\n      frequencies,\n      selectedSteps: this.getInitialSelectedSteps(frequencies),\n      currentStep: 0,\n    };\n\n    this.updateCurrentStepAtInterval = null;\n    this.currentAudioSequencer = null;\n  }\n\n  componentDidMount() {\n    if (this.props.shortID) {\n      fetch(`/api/compositions/${this.props.shortID}`)\n        .then((response) => response.json())\n        .then(({ data }) => {\n          // TODO: load scale config\n          console.log('loaded composition', data);\n        });\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (!_.isEqual(this.props.config, nextProps.config)) {\n      this.onStop();\n      const frequencies = getStepFrequencies(nextProps.config);\n      this.setState({\n        frequencies,\n        selectedSteps: this.getInitialSelectedSteps(frequencies),\n      });\n    }\n  }\n\n  onPlay = () => {\n    this.onStop();\n    const stepDuration = this.getStepDuration();\n    const numSteps = this.getNumSteps();\n    const sequences = buildSequences({\n      selectedSteps: this.state.selectedSteps,\n      frequencies: this.state.frequencies,\n      stepDuration,\n    });\n    this.currentAudioSequencer = new AudioSequencer({\n      audioContext: audioContext,\n      sequences: sequences,\n      totalDuration: numSteps * stepDuration,\n      gain: this.props.gain,\n    });\n    this.currentAudioSequencer.play();\n\n    this.updateCurrentStepAtInterval = setInterval(() => {\n      this.setState({\n        currentStep: (this.state.currentStep + 1) % numSteps,\n      });\n    }, stepDuration * 1000);\n  };\n\n  clearSelectedSteps = (frequencies) => {\n    this.setState({\n      selectedSteps: this.getInitialSelectedSteps(frequencies),\n    });\n  };\n\n  onClear = () => {\n    this.onStop();\n    this.clearSelectedSteps(this.state.frequencies);\n  };\n\n  onStop = () => {\n    this.setState({\n      currentStep: 0,\n    });\n    clearInterval(this.updateCurrentStepAtInterval);\n\n    if (this.currentAudioSequencer) {\n      this.currentAudioSequencer.stop();\n    }\n  };\n\n  onSelectItem = (offset, timeIndex, value) => {\n    this.setState({\n      selectedSteps: update(this.state.selectedSteps, {\n        [offset]: {\n          [timeIndex]: { $set: value },\n        },\n      }),\n    });\n  };\n\n  onExport = () => {\n    const steps = _.range(this.getNumSteps()).map((stepIndex) => {\n      return Object.keys(this.state.selectedSteps)\n        .map((offset) => {\n          return this.state.selectedSteps[offset][stepIndex] ? offset : null;\n        })\n        .filter((offset) => offset);\n    });\n\n    fetch('/api/compositions', {\n      method: 'post',\n      headers: {\n        Accept: 'application/json, text/plain, */*',\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        short_id: shortid.generate(),\n        title: 'untitled',\n        json_value: {\n          scaleConfig: this.props.config,\n          bpm: this.getBeatsPerMinute(),\n          // steps[0] contains an array of the notes at step 0\n          steps: steps,\n        },\n      }),\n    }).then((response) => {\n      console.log('TODO handle composition creation');\n    });\n  };\n\n  getNumNotes(frequencies) {\n    return frequencies.length;\n  }\n\n  getNumSteps() {\n    return 16;\n  }\n\n  getBeatsPerMinute() {\n    return 300;\n  }\n\n  getStepDuration() {\n    return 60 / this.getBeatsPerMinute();\n  }\n\n  getInitialSelectedSteps(frequencies) {\n    const selectedSteps = {};\n    _.range(this.getNumNotes(frequencies)).forEach((offset) => {\n      selectedSteps[offset] = {};\n      _.range(this.getNumSteps()).forEach((timeIndex) => {\n        selectedSteps[offset][timeIndex] = false;\n      });\n    });\n    return selectedSteps;\n  }\n\n  renderRow = (offset) => {\n    const note = getNoteFromOffset(this.props.config, offset);\n    const cents = getCentsForNote(this.props.config, note);\n    return (\n      <div className=\"row no-gutters\" key={offset}>\n        <div className=\"col-1\">\n          <div className=\"text-right pr-2 py-1 line-height-1\">\n            {note}\n            <br />\n            <small>{Math.round(cents)}</small>\n          </div>\n        </div>\n        <div className=\"col\">\n          <div className=\"row no-gutters\">{this.renderRowSteps(offset)}</div>\n        </div>\n      </div>\n    );\n  };\n\n  renderRowSteps = (offset) => {\n    return _.range(this.getNumSteps()).map((stepIndex) => {\n      const isSelected = this.state.selectedSteps[offset][stepIndex];\n      return (\n        <Step\n          selected={isSelected}\n          current={stepIndex === this.state.currentStep}\n          onSelect={this.onSelectItem.bind(this, offset, stepIndex, true)}\n          onDeselect={this.onSelectItem.bind(this, offset, stepIndex, false)}\n          key={stepIndex}\n        />\n      );\n    });\n  };\n\n  render() {\n    const descendingNoteOffsets = _.range(this.getNumNotes(this.state.frequencies) - 1, -1, -1);\n    return (\n      <div>\n        <ComposerSettings\n          onPlay={this.onPlay}\n          onStop={this.onStop}\n          onClear={this.onClear}\n          onExport={this.onExport}\n        />\n        {descendingNoteOffsets.map((offset) => this.renderRow(offset))}\n      </div>\n    );\n  }\n}\n\nexport default Composer;\n","import React from 'react';\nimport classNames from 'classnames';\n\nclass Footer extends React.Component {\n  render() {\n    return (\n      <footer className={classNames('d-flex align-items-end', this.props.className)}>\n        <div className=\"container text-center small my-5\">\n          <div>\n            Built by <a href=\"https://www.kevinqi.com/\">@kevinsqi</a>\n          </div>\n          <div>\n            <a href=\"https://github.com/kevinsqi/microharmonic/\">View source on Github</a>\n          </div>\n        </div>\n      </footer>\n    );\n  }\n}\n\nexport default Footer;\n","// For tracking GA with react-router\n// https://github.com/react-ga/react-ga/issues/122#issuecomment-500497186\nimport { useEffect } from 'react';\nimport ReactGA from 'react-ga';\nimport { withRouter } from 'react-router';\nimport PropTypes from 'prop-types';\n\nfunction sendPageView(location) {\n  ReactGA.set({ page: location.pathname });\n  ReactGA.pageview(location.pathname);\n}\n\nfunction GAListener({ children, trackingId, history }) {\n  useEffect(() => {\n    ReactGA.initialize(trackingId);\n    sendPageView(history.location);\n    return history.listen(sendPageView);\n  }, [history, trackingId]);\n\n  return children;\n}\n\nGAListener.propTypes = {\n  children: PropTypes.node,\n  trackingId: PropTypes.string,\n  history: PropTypes.shape({\n    listen: PropTypes.func,\n  }),\n};\n\nexport default withRouter(GAListener);\n","import React from 'react';\nimport { NavLink } from 'react-router-dom';\n\n/*\nfunction NavButton(props) {\n  return (\n    <NavLink\n      className=\"btn btn-outline-light btn-lg text-left line-height-1 opacity-60\"\n      activeClassName=\"opacity-100\"\n      to={props.to}\n      exact\n    >\n      <div className=\"text-1\">{props.subtitle}</div>\n      <div className=\"mt-1\">{props.title}</div>\n    </NavLink>\n  );\n}\n*/\n\nclass Header extends React.Component {\n  render() {\n    return (\n      <nav\n        className=\"bg-blue d-flex align-items-end\"\n        style={{\n          paddingTop: 60,\n          paddingBottom: 60,\n        }}\n      >\n        <div className=\"container\">\n          <div className=\"d-flex\">\n            <div className=\"mx-auto line-height-1\">\n              <div className=\"position-relative\" style={{ width: 200, height: 110 }}>\n                <div className=\"position-absolute left-0 Parallelogram\" />\n                <div\n                  className=\"position-absolute height-full d-flex flex-column justify-content-center\"\n                  style={{ left: 30 }}\n                >\n                  <NavLink className=\"text-5 text-white\" style={{ fontWeight: 200 }} to=\"/\">\n                    microharmonic\n                  </NavLink>\n                  <div className=\"mt-1\">\n                    <small className=\"text-light\">a web microtone keyboard</small>\n                  </div>\n                </div>\n              </div>\n            </div>\n            {/*\n            <ul className=\"list-inline list-unstyled m-0\">\n              <li className=\"list-inline-item\">\n                <NavButton\n                  to=\"/tutorial\"\n                  title=\"Tutorial\"\n                  subtitle=\"New to microtones?\"\n                />\n              </li>\n              <li className=\"list-inline-item\">\n                <NavButton to=\"/\" title=\"Keyboard\" subtitle=\"Explore\" />\n              </li>\n              <li className=\"list-inline-item\">\n                <NavButton\n                  to=\"/composer\"\n                  title=\"Composer\"\n                  subtitle=\"Write\"\n                />\n              </li>\n            </ul>\n            */}\n          </div>\n        </div>\n      </nav>\n    );\n  }\n}\n\nexport default Header;\n","// See e.g. https://github.com/jxnblk/bumpkit/blob/master/src/Bumpkit.js\n// for audio org example\n\nclass Oscillator {\n  constructor(options = {}) {\n    this.audioContext = options.audioContext;\n    this.gainNode = this.audioContext.createGain();\n    this.gainNode.gain.value = options.gain;\n    this.gainNode.connect(this.audioContext.destination);\n\n    this.oscillators = {};\n  }\n\n  start(freq) {\n    if (this.oscillators[freq]) {\n      return;\n    }\n\n    let oscillator = this.audioContext.createOscillator();\n    oscillator.type = 'sine';\n    oscillator.frequency.value = freq;\n    oscillator.connect(this.gainNode);\n    oscillator.start(0);\n\n    console.log('playing frequency at value', oscillator.frequency.value);\n\n    this.oscillators[freq] = oscillator;\n  }\n\n  stop(freq) {\n    if (!this.oscillators[freq]) {\n      return;\n    }\n\n    this.oscillators[freq].stop(0);\n    this.oscillators[freq].disconnect();\n    delete this.oscillators[freq];\n  }\n}\n\nexport default Oscillator;\n","import React from 'react';\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nimport audioContext from './audioContext';\nimport Oscillator from './audio/Oscillator';\nimport {\n  getCentsForNote,\n  getFrequencyForNote,\n  getNoteFromOffset,\n  getNoteLabel,\n  CENTS_IN_OCTAVE,\n} from './noteHelpers';\n\n// This has to be in pitch ascending order to be able to use getOffsetFromKeyLabel\nconst KEY_LABELS_IN_ROWS = [`zxcvbnm,./`, `asdfghjkl;`, `qwertyuiop`, `1234567890`];\n\nconst KEY_LABELS = KEY_LABELS_IN_ROWS.join(''); // keys in ascending pitch order\n\nfunction getOffsetFromKeyLabel(keyLabel) {\n  const offset = KEY_LABELS.indexOf(keyLabel);\n  if (offset !== -1) {\n    return offset;\n  }\n  return null;\n}\n\n// TODO: rename bindEvents => enableKeyboard, and don't show\n// keyboard letters if disabled. or remove the prop\nclass Keyboard extends React.Component {\n  static defaultProps = {\n    bindEvents: true,\n  };\n\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      activeNotes: {},\n    };\n\n    this.oscillator = new Oscillator({\n      audioContext: audioContext,\n      gain: props.gain,\n    });\n  }\n\n  componentDidMount() {\n    if (this.props.bindEvents) {\n      window.addEventListener('keydown', this.onKeyDown);\n      window.addEventListener('keyup', this.onKeyUp);\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.props.bindEvents) {\n      window.removeEventListener('keydown', this.onKeyDown);\n      window.removeEventListener('keyup', this.onKeyUp);\n    }\n  }\n\n  startNote = (note) => {\n    const freq = getFrequencyForNote(this.props.config, note);\n    this.oscillator.start(freq);\n  };\n\n  stopNote = (note) => {\n    const freq = getFrequencyForNote(this.props.config, note);\n    this.oscillator.stop(freq);\n  };\n\n  onKeyDown = (event) => {\n    if (event.ctrlKey || event.metaKey || event.shiftKey) {\n      return;\n    }\n    this.onKeyActive(event.key);\n  };\n\n  onKeyUp = (event) => {\n    if (event.ctrlKey || event.metaKey || event.shiftKey) {\n      return;\n    }\n    this.onKeyInactive(event.key);\n  };\n\n  onKeyActive(keyLabel) {\n    const note = this.getNoteFromKeyLabel(keyLabel);\n    if (note !== null) {\n      this.startNote(note);\n\n      this.setState({\n        activeNotes: Object.assign({}, this.state.activeNotes, { [note]: true }),\n      });\n    }\n  }\n\n  onKeyInactive(keyLabel) {\n    const note = this.getNoteFromKeyLabel(keyLabel);\n    if (note !== null) {\n      this.stopNote(note);\n\n      this.setState({\n        activeNotes: Object.assign({}, this.state.activeNotes, { [note]: false }),\n      });\n    }\n  }\n\n  getNoteFromKeyLabel(keyLabel) {\n    const offset = getOffsetFromKeyLabel(keyLabel);\n    return getNoteFromOffset(this.props.config, offset);\n  }\n\n  renderKey(keyLabel) {\n    const note = this.getNoteFromKeyLabel(keyLabel);\n    const cents = getCentsForNote(this.props.config, note);\n    return (\n      <button\n        className={classNames('Key', {\n          'Key--octave': cents % CENTS_IN_OCTAVE === 0,\n          'Key--active': this.state.activeNotes[note],\n        })}\n        onMouseDown={this.onKeyActive.bind(this, keyLabel)}\n        onMouseUp={this.onKeyInactive.bind(this, keyLabel)}\n        onMouseLeave={this.onKeyInactive.bind(this, keyLabel)}\n        onTouchStart={this.onKeyActive.bind(this, keyLabel)}\n        onTouchCancel={this.onKeyInactive.bind(this, keyLabel)}\n        onTouchEnd={this.onKeyInactive.bind(this, keyLabel)}\n        key={note}\n      >\n        <div className=\"Key__note\">{getNoteLabel(this.props.config, note)}</div>\n        <div className=\"Key__cents small\">{Math.round(cents)}</div>\n        <div className=\"Key__shortcut small\">{keyLabel}</div>\n      </button>\n    );\n  }\n\n  render() {\n    const reversedRowIndexes = _.range(KEY_LABELS_IN_ROWS.length - 1, -1, -1);\n    return (\n      <div className={classNames('Keyboard', this.props.className)}>\n        {reversedRowIndexes.map((rowIndex) => {\n          const keyLabels = KEY_LABELS_IN_ROWS[rowIndex].split('');\n          return (\n            <div className={classNames('Keyrow', `Keyrow--${rowIndex}`)} key={rowIndex}>\n              {keyLabels.map((keyLabel) => this.renderKey(keyLabel))}\n            </div>\n          );\n        })}\n      </div>\n    );\n  }\n}\n\nexport default Keyboard;\n","import React from 'react';\n\nfunction Label(props) {\n  return <label className=\"Label text-secondary\">{props.children}</label>;\n}\n\nexport default Label;\n","import React from 'react';\nimport _ from 'lodash';\n\nimport Label from './Label';\nimport { CENTS_IN_OCTAVE } from './noteHelpers';\n\nconst DEFAULT_PRESET_NAME = '12_ET';\n\nconst PRESETS = [\n  {\n    name: '12_ET',\n    label: '12 tone equal temperament',\n    values: _.range(0, CENTS_IN_OCTAVE, 100),\n  },\n  {\n    name: 'just_intonation',\n    label: 'Just intonation',\n    values: [\n      0,\n      111.73,\n      203.91,\n      315.64,\n      386.31,\n      498.04,\n      582.51,\n      701.96,\n      813.69,\n      884.36,\n      996.09,\n      1088.27,\n    ],\n  },\n];\n\nconst PRESETS_MAP = PRESETS.reduce((map, elem) => {\n  map[elem.name] = elem;\n  return map;\n}, {});\n\nfunction parseCustomCentValuesStr(str) {\n  const values = str\n    .trim()\n    .split(/\\s+/)\n    .map((value) => parseFloat(value))\n    .sort((a, b) => a - b);\n\n  if (values.some((value) => isNaN(value))) {\n    throw new Error('Has invalid value which is not a number');\n  } else if (values.some((value) => value < 0 || value > CENTS_IN_OCTAVE)) {\n    throw new Error('Has out of range cent value (must be between 0 and 1200)');\n  }\n  return values;\n}\n\nfunction stringifyCustomCentValues(values) {\n  return values.join('\\n');\n}\n\nclass CustomSettings extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      presetName: DEFAULT_PRESET_NAME,\n      customCentValuesStr: stringifyCustomCentValues(props.config.customCentValues),\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (this.state.customCentValuesStr !== nextProps.config.customCentValues) {\n      this.setState({\n        customCentValuesStr: stringifyCustomCentValues(nextProps.config.customCentValues),\n      });\n    }\n  }\n\n  onChangeCustomCentValues = (event) => {\n    this.setState({\n      customCentValuesStr: event.target.value,\n    });\n  };\n\n  onSaveCustomCentValues = (event) => {\n    try {\n      const values = parseCustomCentValuesStr(this.state.customCentValuesStr);\n      this.props.setConfig({\n        customCentValues: values,\n      });\n    } catch (error) {\n      alert('Sorry, there was an error interpreting these values.');\n    }\n  };\n\n  onChangePreset = (event) => {\n    const presetName = event.target.value;\n    const values = PRESETS_MAP[presetName].values;\n    this.setState({\n      presetName: presetName,\n    });\n    this.props.setConfig({\n      customCentValues: values,\n    });\n  };\n\n  render() {\n    return (\n      <div>\n        <Label>Custom scale tuning</Label>\n        <div className=\"row\">\n          <div className=\"col-sm-6\">\n            <small className=\"text-muted\">\n              Enter cent values between 0 and 1200, separated by line breaks\n            </small>\n            <textarea\n              className=\"form-control\"\n              rows=\"10\"\n              value={this.state.customCentValuesStr}\n              onChange={this.onChangeCustomCentValues}\n            />\n            <div className=\"mt-3\">\n              <button className=\"btn btn-primary\" onClick={this.onSaveCustomCentValues}>\n                Apply\n              </button>\n            </div>\n          </div>\n          <div className=\"col-sm-6\">\n            <small className=\"text-muted\">...or select a preset:</small>\n            <select\n              className=\"form-control\"\n              value={this.state.presetName}\n              onChange={this.onChangePreset}\n            >\n              {PRESETS.map((preset) => (\n                <option value={preset.name} key={preset.name}>\n                  {preset.label}\n                </option>\n              ))}\n            </select>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default CustomSettings;\n","import React from 'react';\nimport _ from 'lodash';\nimport pluralize from 'pluralize';\nimport classNames from 'classnames';\n\nimport Label from './Label';\nimport { getNoteLabel } from './noteHelpers';\n\nconst MAX_NUM_STEPS = 100;\nconst MAX_NUM_OCTAVES = 10;\n\nclass EqualTemperamentSettings extends React.Component {\n  reset() {\n    this.props.setConfig({\n      selectedNotes: {},\n    });\n  }\n\n  onChangeLowestNote = (event) => {\n    this.reset();\n    this.props.setConfig({\n      lowestNote: event.target.value,\n    });\n  };\n\n  onChangeNumOctaves = (event) => {\n    this.reset();\n    this.props.setConfig({\n      numOctaves: parseInt(event.target.value, 10),\n    });\n  };\n\n  onChangeNumSteps = (event) => {\n    this.reset();\n    this.props.setConfig({\n      numSteps: parseInt(event.target.value, 10),\n    });\n  };\n\n  onChangeSelectedNotes = (event) => {\n    const note = parseInt(event.target.name, 10);\n    const value = event.target.checked;\n\n    const selectedNotes = value\n      ? Object.assign({}, this.props.config.selectedNotes, { [note]: true })\n      : _.omit(this.props.config.selectedNotes, note);\n\n    this.props.setConfig({\n      selectedNotes: selectedNotes,\n    });\n  };\n\n  onClickResetSelectedNotes = () => {\n    this.reset();\n  };\n\n  renderStepSettings() {\n    return (\n      <div>\n        <div>\n          <Label>Octave division</Label>\n        </div>\n\n        <div className=\"form-inline\">\n          <select\n            className=\"form-control\"\n            value={this.props.config.numOctaves}\n            onChange={this.onChangeNumOctaves}\n          >\n            {_.range(MAX_NUM_OCTAVES).map((index) => {\n              const label = pluralize('octave', index + 1, true);\n              return (\n                <option value={index + 1} key={index}>\n                  {label}\n                </option>\n              );\n            })}\n          </select>\n          <span className=\"mx-2\">into</span>\n          <select\n            className=\"form-control\"\n            value={this.props.config.numSteps}\n            onChange={this.onChangeNumSteps}\n          >\n            {_.range(MAX_NUM_STEPS).map((index) => {\n              const label = pluralize('step', index + 1, true);\n              return (\n                <option value={index + 1} key={index}>\n                  {label}\n                </option>\n              );\n            })}\n          </select>\n        </div>\n      </div>\n    );\n  }\n\n  renderNotePicker() {\n    return (\n      <div>\n        <div>\n          <Label>Notes to include</Label>\n        </div>\n\n        <div>\n          {_.range(this.props.config.numSteps).map((note) => {\n            return (\n              <label\n                className={classNames('mr-1 mb-1', 'NoteLabel', {\n                  'NoteLabel--selected': this.props.config.selectedNotes[note],\n                })}\n                key={note}\n              >\n                <input\n                  className=\"form-control d-none\"\n                  type=\"checkbox\"\n                  name={note}\n                  checked={!!this.props.config.selectedNotes[note]}\n                  onChange={this.onChangeSelectedNotes}\n                />\n                {getNoteLabel(this.props.config, note)}\n              </label>\n            );\n          })}\n          <button className=\"ml-4 btn btn-link\" onClick={this.onClickResetSelectedNotes}>\n            Reset\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  renderLowestNoteSetting() {\n    return (\n      <div>\n        <div>\n          <Label>Lowest note</Label>\n        </div>\n        <div className=\"form-inline\">\n          <select\n            className=\"form-control\"\n            value={this.props.config.lowestNote}\n            onChange={this.onChangeLowestNote}\n            style={{ width: '60px' }}\n          >\n            {['c3', 'c4', 'c5', 'c6'].map((noteName) => {\n              return (\n                <option value={noteName} key={noteName}>\n                  {noteName}\n                </option>\n              );\n            })}\n          </select>\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <div className=\"row\">\n        <div className=\"col-sm-4 mt-4\">{this.renderStepSettings()}</div>\n        <div className=\"col-sm-2 mt-4\">{this.renderLowestNoteSetting()}</div>\n        <div className=\"col-sm-6 mt-4\">{this.renderNotePicker()}</div>\n      </div>\n    );\n  }\n}\n\nexport default EqualTemperamentSettings;\n","import React from 'react';\nimport classNames from 'classnames';\n\nimport CustomSettings from './CustomSettings';\nimport EqualTemperamentSettings from './EqualTemperamentSettings';\n\nclass Settings extends React.Component {\n  toggleCustomSettings(useCustom) {\n    this.props.setConfig({\n      useCustomCentValues: useCustom,\n    });\n  }\n\n  render() {\n    const activeClass = 'btn-primary';\n    const inactiveClass = 'btn-outline-secondary';\n    const { useCustomCentValues } = this.props.config;\n\n    return (\n      <div>\n        <div className=\"text-center\">\n          <div className=\"btn-group btn-group-lg\">\n            <button\n              className={classNames('btn', useCustomCentValues ? inactiveClass : activeClass)}\n              onClick={() => this.toggleCustomSettings(false)}\n            >\n              Equal temperament\n            </button>\n            <button\n              className={classNames('btn', useCustomCentValues ? activeClass : inactiveClass)}\n              onClick={() => this.toggleCustomSettings(true)}\n            >\n              Custom tuning\n            </button>\n          </div>\n        </div>\n        <div className=\"mt-5\">\n          {useCustomCentValues ? (\n            <CustomSettings config={this.props.config} setConfig={this.props.setConfig} />\n          ) : (\n            <EqualTemperamentSettings config={this.props.config} setConfig={this.props.setConfig} />\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Settings;\n","import React from 'react';\n\nimport Keyboard from './Keyboard';\n\nfunction Tutorial(props) {\n  // TODO: swap in photos with own illustrations\n  // TODO: show weird physical microtone keyboards\n  return (\n    <div className=\"container my5\">\n      <div className=\"row\">\n        <div className=\"col-md-10 offset-md-1 col-lg-8 offset-lg-2\">\n          <h1 className=\"text-muted\">01. An introduction to microtones</h1>\n          <div className=\"row py-3\">\n            <div className=\"col-12 col-md-10 offset-md-1\">\n              <img\n                className=\"w-100\"\n                src=\"http://www.agnes-bruckner.com/apronus_images/facepiano.gif\"\n                alt=\"piano keyboard\"\n              />\n            </div>\n          </div>\n          <p>\n            C, Db, D, Eb, E, F, Gb, G, Ab, A, Bb, and B. From these 12 notes we can play pretty much\n            any song that we know of in modern music. The approach of dividing an octave equally is\n            known as \"equal temperament\". You can try it out with a 12EDO keyboard here.\n          </p>\n          <div>\n            <Keyboard\n              config={{\n                useCustomCentValues: false,\n                lowestNote: 'c4',\n                numOctaves: 1,\n                numSteps: 12,\n                selectedNotes: {},\n              }}\n              gain={props.gain}\n              bindEvents={false}\n            />\n          </div>\n          <p className=\"mt-3\">\n            This 12 tone scale originates back to 1584, when Zhu Zaiyu developed the mathematical\n            basis for dividing the octave equally into 12 parts. Zhu Zaiyu was a prince of the Ming\n            court in China, and spent thirty years researching equal temperament. He demonstrated\n            this 12 note division by constructing a set of bamboo pipes over three octaves, and\n            increasing the length of the each pipe by a factor of the twelfth root of 2.\n          </p>\n          <div className=\"row py-3\">\n            <div className=\"col-md-6 offset-md-3\">\n              <img\n                className=\"w-100\"\n                src=\"https://upload.wikimedia.org/wikipedia/commons/f/f2/%E4%B9%90%E5%BE%8B%E5%85%A8%E4%B9%A6%E5%85%A8-1154.jpg\"\n                alt=\"bamboo pipes\"\n              />\n            </div>\n          </div>\n          <p>The \"distance\", or \"interval\", between any two notes is the same in 12EDO.</p>\n          <p>\n            But you can make many more sounds than just these 12 notes. Just use your voice to hum\n            from C to D and youve produced a continuous spectrum of frequencies that aren't in\n            12EDO. And its not just voice. Here are some other instruments that can traverse\n            between notes:\n          </p>\n          <div className=\"row my-3\">\n            <div className=\"col-12 text-center\">\n              <img\n                height=\"150\"\n                src=\"https://static1.squarespace.com/static/57d2f09a6b8f5b98b30057f4/t/58cb1879414fb534eec71f43/1492026344786/\"\n                alt=\"trombone\"\n              />\n              <img\n                height=\"150\"\n                src=\"https://images-na.ssl-images-amazon.com/images/I/61NJglqoJVL._SL1500_.jpg\"\n                alt=\"otomatone\"\n              />\n              <img\n                height=\"150\"\n                src=\"http://media.guitarcenter.com/is/image/MMGS7/Prelude-Series-Violin-Outfit-1-8-Size/J05662000001000-00-500x500.jpg\"\n                alt=\"violin\"\n              />\n            </div>\n          </div>\n          <p>\n            Microtones refer to the use of intervals that dont fit within this ubiquitous 12 tone\n            structure. Listen to this microtonal song:\n          </p>\n          <div>\n            <iframe\n              title=\"soundcloud_the_juggler\"\n              width=\"100%\"\n              height=\"150\"\n              scrolling=\"no\"\n              frameBorder=\"no\"\n              src=\"https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/146753233&amp;color=%23ff5500&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;show_teaser=true&amp;visual=true\"\n            />\n          </div>\n          <p>\n            The composer notes that this was written in 19EDO. You can play around with 19EDO here.\n            {/* TODO: use Composer to actually transcribe The Juggler */}\n          </p>\n          <div>\n            <Keyboard\n              config={{\n                useCustomCentValues: false,\n                lowestNote: 'c4',\n                numOctaves: 1,\n                numSteps: 19,\n                selectedNotes: {},\n              }}\n              gain={props.gain}\n              bindEvents={false}\n            />\n          </div>\n          <p>\n            Microtonal music can also sound quite strange and wonderful. This song by Sevish uses a\n            53EDO scale:\n          </p>\n          <div>\n            <iframe\n              title=\"soundcloud_sevish_droplet\"\n              width=\"100%\"\n              height=\"150\"\n              scrolling=\"no\"\n              frameBorder=\"no\"\n              src=\"https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/212652160&amp;color=%23b89890&amp;auto_play=false&amp;hide_related=false&amp;show_comments=true&amp;show_user=true&amp;show_reposts=false&amp;show_teaser=true&amp;visual=true\"\n            />\n          </div>\n          <h2 className=\"h4 font-weight-bold mt4\">Frequencies and cents</h2>\n          <p>\n            Our perception of sound is on a logarithmic scale relative to frequency. An octave, from\n            C to C or D to D or so on, is when you double the frequency. Middle C is 440hz. Go up an\n            octave to 880hz. Being logarithmic isnt super convenient relative to our perception,\n            which is linear. So we can use cents instead, which is defined as:\n          </p>\n          <div>\n            <iframe\n              title=\"binky_doesnt_understand\"\n              width=\"560\"\n              height=\"315\"\n              src=\"https://www.youtube.com/embed/taCNT81k1v8?rel=0\"\n              frameBorder=\"0\"\n              allowFullScreen\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default Tutorial;\n","import React from 'react';\nimport _ from 'lodash';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\n\nimport './App.css';\nimport Composer from './Composer';\nimport Footer from './Footer';\nimport GAListener from './GAListener';\nimport Header from './Header';\nimport Keyboard from './Keyboard';\nimport Settings from './Settings';\nimport Tutorial from './Tutorial';\nimport { CENTS_IN_OCTAVE } from './noteHelpers';\n\nconst GAIN_VALUE = 0.1;\n\nfunction SettingsWrapper(props) {\n  return (\n    <div className=\"container d-flex flex-column height-full\">\n      <div className=\"flex-1\">{props.children}</div>\n      <div className=\"mt-5\">\n        <Settings config={props.config} setConfig={props.setConfig} />\n      </div>\n    </div>\n  );\n}\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      config: {\n        useCustomCentValues: false,\n        // TODO: make this be in sync with CustomSettings preset\n        customCentValues: _.range(0, CENTS_IN_OCTAVE, 100),\n        lowestNote: 'c4',\n        numOctaves: 1,\n        numSteps: 24,\n        selectedNotes: {},\n      },\n    };\n  }\n\n  setConfig = (config) => {\n    this.setState({\n      config: Object.assign({}, this.state.config, config),\n    });\n  };\n\n  render() {\n    return (\n      <Router>\n        <GAListener trackingId=\"UA-145919044-1\">\n          <div className=\"d-flex flex-column height-full\">\n            <Header />\n            <div className=\"flex-1\" style={{ paddingTop: 80 }}>\n              <Route\n                exact\n                path=\"/\"\n                render={() => (\n                  <SettingsWrapper config={this.state.config} setConfig={this.setConfig}>\n                    <div className=\"d-flex\">\n                      <Keyboard className=\"mx-auto\" config={this.state.config} gain={GAIN_VALUE} />\n                    </div>\n                  </SettingsWrapper>\n                )}\n              />\n              <Route\n                exact\n                path=\"/composer\"\n                render={() => (\n                  <SettingsWrapper config={this.state.config} setConfig={this.setConfig}>\n                    <Composer config={this.state.config} gain={GAIN_VALUE} />\n                  </SettingsWrapper>\n                )}\n              />\n              <Route\n                exact\n                path=\"/composer/:shortID\"\n                render={(props) => (\n                  <SettingsWrapper config={this.state.config} setConfig={this.setConfig}>\n                    <Composer\n                      config={this.state.config}\n                      gain={GAIN_VALUE}\n                      shortID={props.match.params.shortID}\n                    />\n                  </SettingsWrapper>\n                )}\n              />\n              <Route exact path=\"/tutorial\" render={() => <Tutorial gain={GAIN_VALUE} />} />\n            </div>\n            <Footer className=\"mt-3\" />\n          </div>\n        </GAListener>\n      </Router>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\n// App\nimport App from './App';\n\n// Styling\nimport 'typeface-inter';\nimport './index.css';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}